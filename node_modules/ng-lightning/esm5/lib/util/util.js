import { __assign, __read, __spread } from "tslib";
// Check if given value is integer. Cast strings as potential integers as well.
// See: http://stackoverflow.com/questions/14636536/how-to-check-if-a-variable-is-an-integer-in-javascript
export function isInt(value) {
    if (isNaN(value)) {
        return false;
    }
    var x = parseFloat(value);
    // tslint:disable-next-line:no-bitwise
    return (x | 0) === x;
}
// Similar to `lodash.isobject`
export function isObject(value) {
    var type = typeof value;
    return !!value && (type === 'object' || type === 'function');
}
// Generate a unique id (unique within the entire client session).
// Useful for temporary DOM ids.
var idCounter = 0;
export function uniqueId(prefix) {
    if (prefix === void 0) { prefix = 'uid'; }
    return "ngl_" + prefix + "_" + ++idCounter;
}
export function replaceClass(instance, oldClass, newClass) {
    if (oldClass && oldClass !== newClass) {
        setClass(instance, oldClass, false);
    }
    if (newClass) {
        setClass(instance, newClass, true);
    }
}
function setClass(instance, klasses, isAdd) {
    if (klasses) {
        (Array.isArray(klasses) ? klasses : [klasses]).forEach(function (k) {
            instance.renderer[isAdd ? 'addClass' : 'removeClass'](instance.element.nativeElement, k);
        });
    }
}
export function ngClassCombine(ngClasses, customClasses) {
    if (!ngClasses) {
        return customClasses;
    }
    // Convert string and Set to array
    if (typeof ngClasses === 'string') {
        ngClasses = ngClasses.split(/\s+/);
    }
    else if (ngClasses instanceof Set) {
        var a_1 = [];
        ngClasses.forEach(function (v) { return a_1.push(v); });
        ngClasses = a_1;
    }
    // Convert array to object
    if (Array.isArray(ngClasses)) {
        ngClasses = ngClasses.reduce(function (o, klass) {
            o[klass] = true;
            return o;
        }, {});
    }
    return __assign(__assign({}, ngClasses), customClasses);
}
/**
   * Check whether value is currently selected.
   *
   * @param selection The value(s) currently selected
   * @param value The value in test, whether is (part of) selection or not
   * @param multiple Whether selections can be have multiple values
   */
export function isOptionSelected(value, selection, multiple) {
    // Multiple
    if (multiple) {
        if (!selection) {
            return false;
        }
        return Array.isArray(selection) ? selection.indexOf(value) > -1 : !!selection[value];
    }
    // Single
    return value === selection;
}
export function addOptionToSelection(value, selection, multiple) {
    var _a;
    var next;
    if (multiple) {
        if (!selection) {
            selection = [];
        }
        if (Array.isArray(selection)) {
            // Remove if already there or add to selection
            var index = selection.indexOf(value);
            next = index > -1
                ? __spread(selection.slice(0, index), selection.slice(index + 1)) : __spread(selection, [value]);
        }
        else {
            next = Object.assign({}, selection, (_a = {}, _a[value] = !selection[value], _a));
        }
    }
    else {
        next = selection === value ? null : value;
    }
    return next;
}
export function menuItemScroll(container, domItem, scrollPadding) {
    if (scrollPadding === void 0) { scrollPadding = 4; }
    if (domItem.offsetHeight - container.scrollTop + domItem.offsetTop >=
        container.offsetHeight) {
        container.scrollTop =
            domItem.offsetHeight +
                domItem.offsetTop -
                container.offsetHeight +
                scrollPadding;
    }
    else if (domItem.offsetTop <= container.scrollTop) {
        container.scrollTop = domItem.offsetTop - scrollPadding;
    }
}
export function trapEvent(event) {
    if (!event) {
        return;
    }
    event.preventDefault();
    event.stopPropagation();
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidXRpbC5qcyIsInNvdXJjZVJvb3QiOiJuZzovL25nLWxpZ2h0bmluZy8iLCJzb3VyY2VzIjpbImxpYi91dGlsL3V0aWwudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUVBLCtFQUErRTtBQUMvRSwwR0FBMEc7QUFDMUcsTUFBTSxVQUFVLEtBQUssQ0FBQyxLQUFVO0lBQzlCLElBQUksS0FBSyxDQUFDLEtBQUssQ0FBQyxFQUFFO1FBQ2hCLE9BQU8sS0FBSyxDQUFDO0tBQ2Q7SUFDRCxJQUFNLENBQUMsR0FBRyxVQUFVLENBQUMsS0FBSyxDQUFDLENBQUM7SUFDNUIsc0NBQXNDO0lBQ3RDLE9BQU8sQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLEtBQUssQ0FBQyxDQUFDO0FBQ3ZCLENBQUM7QUFFRCwrQkFBK0I7QUFDL0IsTUFBTSxVQUFVLFFBQVEsQ0FBQyxLQUFVO0lBQ2pDLElBQU0sSUFBSSxHQUFHLE9BQU8sS0FBSyxDQUFDO0lBQzFCLE9BQU8sQ0FBQyxDQUFDLEtBQUssSUFBSSxDQUFDLElBQUksS0FBSyxRQUFRLElBQUksSUFBSSxLQUFLLFVBQVUsQ0FBQyxDQUFDO0FBQy9ELENBQUM7QUFFRCxrRUFBa0U7QUFDbEUsZ0NBQWdDO0FBQ2hDLElBQUksU0FBUyxHQUFHLENBQUMsQ0FBQztBQUNsQixNQUFNLFVBQVUsUUFBUSxDQUFDLE1BQWM7SUFBZCx1QkFBQSxFQUFBLGNBQWM7SUFDckMsT0FBTyxTQUFPLE1BQU0sU0FBSSxFQUFFLFNBQVcsQ0FBQztBQUN4QyxDQUFDO0FBTUQsTUFBTSxVQUFVLFlBQVksQ0FBQyxRQUF1QixFQUFFLFFBQTJCLEVBQUUsUUFBNEI7SUFDN0csSUFBSSxRQUFRLElBQUksUUFBUSxLQUFLLFFBQVEsRUFBRTtRQUNyQyxRQUFRLENBQUMsUUFBUSxFQUFFLFFBQVEsRUFBRSxLQUFLLENBQUMsQ0FBQztLQUNyQztJQUNELElBQUksUUFBUSxFQUFFO1FBQ1osUUFBUSxDQUFDLFFBQVEsRUFBRSxRQUFRLEVBQUUsSUFBSSxD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QUUsS0FBSyxFQUFDLENBQUM7U0FDM0I7YUFBTTtZQUNMLElBQUksR0FBRyxNQUFNLENBQUMsTUFBTSxDQUFDLEVBQUUsRUFBRSxTQUFTLFlBQUksR0FBQyxLQUFLLElBQUcsQ0FBQyxTQUFTLENBQUMsS0FBSyxDQUFDLE1BQUcsQ0FBQztTQUNyRTtLQUNGO1NBQU07UUFDTCxJQUFJLEdBQUcsU0FBUyxLQUFLLEtBQUssQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxLQUFLLENBQUM7S0FDM0M7SUFFRCxPQUFPLElBQUksQ0FBQztBQUNkLENBQUM7QUFFRCxNQUFNLFVBQVUsY0FBYyxDQUFFLFNBQVMsRUFBRSxPQUFPLEVBQUUsYUFBaUI7SUFBakIsOEJBQUEsRUFBQSxpQkFBaUI7SUFDbkUsSUFDRSxPQUFPLENBQUMsWUFBWSxHQUFHLFNBQVMsQ0FBQyxTQUFTLEdBQUcsT0FBTyxDQUFDLFNBQVM7UUFDOUQsU0FBUyxDQUFDLFlBQVksRUFDdEI7UUFDQSxTQUFTLENBQUMsU0FBUztZQUNqQixPQUFPLENBQUMsWUFBWTtnQkFDcEIsT0FBTyxDQUFDLFNBQVM7Z0JBQ2pCLFNBQVMsQ0FBQyxZQUFZO2dCQUN0QixhQUFhLENBQUM7S0FDakI7U0FBTSxJQUFJLE9BQU8sQ0FBQyxTQUFTLElBQUksU0FBUyxDQUFDLFNBQVMsRUFBRTtRQUNuRCxTQUFTLENBQUMsU0FBUyxHQUFHLE9BQU8sQ0FBQyxTQUFTLEdBQUcsYUFBYSxDQUFDO0tBQ3pEO0FBQ0gsQ0FBQztBQUVELE1BQU0sVUFBVSxTQUFTLENBQUMsS0FBWTtJQUNwQyxJQUFJLENBQUMsS0FBSyxFQUFFO1FBQUUsT0FBTztLQUFFO0lBQ3ZCLEtBQUssQ0FBQyxjQUFjLEVBQUUsQ0FBQztJQUN2QixLQUFLLENBQUMsZUFBZSxFQUFFLENBQUM7QUFDMUIsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEVsZW1lbnRSZWYsIFJlbmRlcmVyMiB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuXG4vLyBDaGVjayBpZiBnaXZlbiB2YWx1ZSBpcyBpbnRlZ2VyLiBDYXN0IHN0cmluZ3MgYXMgcG90ZW50aWFsIGludGVnZXJzIGFzIHdlbGwuXG4vLyBTZWU6IGh0dHA6Ly9zdGFja292ZXJmbG93LmNvbS9xdWVzdGlvbnMvMTQ2MzY1MzYvaG93LXRvLWNoZWNrLWlmLWEtdmFyaWFibGUtaXMtYW4taW50ZWdlci1pbi1qYXZhc2NyaXB0XG5leHBvcnQgZnVuY3Rpb24gaXNJbnQodmFsdWU6IGFueSk6IGJvb2xlYW4ge1xuICBpZiAoaXNOYU4odmFsdWUpKSB7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG4gIGNvbnN0IHggPSBwYXJzZUZsb2F0KHZhbHVlKTtcbiAgLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOm5vLWJpdHdpc2VcbiAgcmV0dXJuICh4IHwgMCkgPT09IHg7XG59XG5cbi8vIFNpbWlsYXIgdG8gYGxvZGFzaC5pc29iamVjdGBcbmV4cG9ydCBmdW5jdGlvbiBpc09iamVjdCh2YWx1ZTogYW55KTogYm9vbGVhbiB7XG4gIGNvbnN0IHR5cGUgPSB0eXBlb2YgdmFsdWU7XG4gIHJldHVybiAhIXZhbHVlICYmICh0eXBlID09PSAnb2JqZWN0JyB8fCB0eXBlID09PSAnZnVuY3Rpb24nKTtcbn1cblxuLy8gR2VuZXJhdGUgYSB1bmlxdWUgaWQgKHVuaXF1ZSB3aXRoaW4gdGhlIGVudGlyZSBjbGllbnQgc2Vzc2lvbikuXG4vLyBVc2VmdWwgZm9yIHRlbXBvcmFyeSBET00gaWRzLlxubGV0IGlkQ291bnRlciA9IDA7XG5leHBvcnQgZnVuY3Rpb24gdW5pcXVlSWQocHJlZml4ID0gJ3VpZCcpIHtcbiAgcmV0dXJuIGBuZ2xfJHtwcmVmaXh9XyR7KytpZENvdW50ZXJ9YDtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBJUmVwbGFjZUNsYXNzIHtcbiAgcmVuZGVyZXI6IFJlbmRlcmVyMjtcbiAgZWxlbWVudDogRWxlbWVudFJlZjtcbn1cbmV4cG9ydCBmdW5jdGlvbiByZXBsYWNlQ2xhc3MoaW5zdGFuY2U6IElSZXBsYWNlQ2xhc3MsIG9sZENsYXNzOiBzdHJpbmcgfCBzdHJpbmdbXSwgbmV3Q2xhc3M/OiBzdHJpbmcgfCBzdHJpbmdbXSkge1xuICBpZiAob2xkQ2xhc3MgJiYgb2xkQ2xhc3MgIT09IG5ld0NsYXNzKSB7XG4gICAgc2V0Q2xhc3MoaW5zdGFuY2UsIG9sZENsYXNzLCBmYWxzZSk7XG4gIH1cbiAgaWYgKG5ld0NsYXNzKSB7XG4gICAgc2V0Q2xhc3MoaW5zdGFuY2UsIG5ld0NsYXNzLCB0cnVlKTtcbiAgfVxufVxuXG5mdW5jdGlvbiBzZXRDbGFzcyhpbnN0YW5jZTogSVJlcGxhY2VDbGFzcywga2xhc3Nlczogc3RyaW5nIHwgc3RyaW5nW10sIGlzQWRkOiBib29sZWFuKSB7XG4gIGlmIChrbGFzc2VzKSB7XG4gICAgKEFycmF5LmlzQXJyYXkoa2xhc3NlcykgPyBrbGFzc2VzIDogW2tsYXNzZXNdKS5mb3JFYWNoKGsgPT4ge1xuICAgICAgaW5zdGFuY2UucmVuZGVyZXJbaXNBZGQgPyAnYWRkQ2xhc3MnIDogJ3JlbW92ZUNsYXNzJ10oaW5zdGFuY2UuZWxlbWVudC5uYXRpdmVFbGVtZW50LCBrKTtcbiAgICB9KTtcbiAgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24gbmdDbGFzc0NvbWJpbmUobmdDbGFzc2VzOiBzdHJpbmcgfCBzdHJpbmdbXSB8IFNldDxzdHJpbmc+IHwgeyBba2xhc3M6IHN0cmluZ106IGFueSB9LCBjdXN0b21DbGFzc2VzOiB7IFtrbGFzczogc3RyaW5nXTogYW55IH0pIHtcbiAgaWYgKCFuZ0NsYXNzZXMpIHtcbiAgICByZXR1cm4gY3VzdG9tQ2xhc3NlcztcbiAgfVxuXG4gIC8vIENvbnZlcnQgc3RyaW5nIGFuZCBTZXQgdG8gYXJyYXlcbiAgaWYgKHR5cGVvZiBuZ0NsYXNzZXMgPT09ICdzdHJpbmcnKSB7XG4gICAgbmdDbGFzc2VzID0gbmdDbGFzc2VzLnNwbGl0KC9cXHMrLyk7XG4gIH0gZWxzZSAgaWYgKG5nQ2xhc3NlcyBpbnN0YW5jZW9mIFNldCkge1xuICAgIGNvbnN0IGEgPSBbXTtcbiAgICBuZ0NsYXNzZXMuZm9yRWFjaCh2ID0+IGEucHVzaCh2KSk7XG4gICAgbmdDbGFzc2VzID0gYTtcbiAgfVxuXG4gIC8vIENvbnZlcnQgYXJyYXkgdG8gb2JqZWN0XG4gIGlmIChBcnJheS5pc0FycmF5KG5nQ2xhc3NlcykpIHtcbiAgICBuZ0NsYXNzZXMgPSBuZ0NsYXNzZXMucmVkdWNlKChvOiBPYmplY3QsIGtsYXNzOiBzdHJpbmcpID0+IHtcbiAgICAgIG9ba2xhc3NdID0gdHJ1ZTtcbiAgICAgIHJldHVybiBvO1xuICAgIH0sIHt9KTtcbiAgfVxuXG4gIHJldHVybiB7Li4ubmdDbGFzc2VzLCAuLi5jdXN0b21DbGFzc2VzfTtcbn1cblxuXG4vKipcbiAgICogQ2hlY2sgd2hldGhlciB2YWx1ZSBpcyBjdXJyZW50bHkgc2VsZWN0ZWQuXG4gICAqXG4gICAqIEBwYXJhbSBzZWxlY3Rpb24gVGhlIHZhbHVlKHMpIGN1cnJlbnRseSBzZWxlY3RlZFxuICAgKiBAcGFyYW0gdmFsdWUgVGhlIHZhbHVlIGluIHRlc3QsIHdoZXRoZXIgaXMgKHBhcnQgb2YpIHNlbGVjdGlvbiBvciBub3RcbiAgICogQHBhcmFtIG11bHRpcGxlIFdoZXRoZXIgc2VsZWN0aW9ucyBjYW4gYmUgaGF2ZSBtdWx0aXBsZSB2YWx1ZXNcbiAgICovXG5leHBvcnQgZnVuY3Rpb24gaXNPcHRpb25TZWxlY3RlZCh2YWx1ZTogc3RyaW5nIHwgbnVtYmVyIHwgYW55LCBzZWxlY3Rpb246IGFueSB8IGFueVtdLCBtdWx0aXBsZTogYm9vbGVhbik6IGJvb2xlYW4ge1xuICAvLyBNdWx0aXBsZVxuICBpZiAobXVsdGlwbGUpIHtcbiAgICBpZiAoIXNlbGVjdGlvbikgeyByZXR1cm4gZmFsc2U7IH1cbiAgICByZXR1cm4gQXJyYXkuaXNBcnJheShzZWxlY3Rpb24pID8gc2VsZWN0aW9uLmluZGV4T2YodmFsdWUpID4gLTEgOiAhIXNlbGVjdGlvblt2YWx1ZV07XG4gIH1cblxuICAvLyBTaW5nbGVcbiAgcmV0dXJuIHZhbHVlID09PSBzZWxlY3Rpb247XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBhZGRPcHRpb25Ub1NlbGVjdGlvbih2YWx1ZTogc3RyaW5nIHwgbnVtYmVyIHwgYW55LCBzZWxlY3Rpb246IGFueSB8IGFueVtdLCBtdWx0aXBsZTogYm9vbGVhbikge1xuICBsZXQgbmV4dDogYW55O1xuICBpZiAobXVsdGlwbGUpIHtcbiAgICBpZiAoIXNlbGVjdGlvbikge1xuICAgICAgc2VsZWN0aW9uID0gW107XG4gICAgfVxuICAgIGlmIChBcnJheS5pc0FycmF5KHNlbGVjdGlvbikpIHtcbiAgICAgIC8vIFJlbW92ZSBpZiBhbHJlYWR5IHRoZXJlIG9yIGFkZCB0byBzZWxlY3Rpb25cbiAgICAgIGNvbnN0IGluZGV4ID0gc2VsZWN0aW9uLmluZGV4T2YodmFsdWUpO1xuICAgICAgbmV4dCA9IGluZGV4ID4gLTFcbiAgICAgICAgPyBbLi4uc2VsZWN0aW9uLnNsaWNlKDAsIGluZGV4KSwgLi4uc2VsZWN0aW9uLnNsaWNlKGluZGV4ICsgMSldXG4gICAgICAgIDogWy4uLnNlbGVjdGlvbiwgdmFsdWVdO1xuICAgIH0gZWxzZSB7XG4gICAgICBuZXh0ID0gT2JqZWN0LmFzc2lnbih7fSwgc2VsZWN0aW9uLCB7IFt2YWx1ZV06ICFzZWxlY3Rpb25bdmFsdWVdIH0pO1xuICAgIH1cbiAgfSBlbHNlIHtcbiAgICBuZXh0ID0gc2VsZWN0aW9uID09PSB2YWx1ZSA/IG51bGwgOiB2YWx1ZTtcbiAgfVxuXG4gIHJldHVybiBuZXh0O1xufVxuXG5leHBvcnQgZnVuY3Rpb24gbWVudUl0ZW1TY3JvbGwgKGNvbnRhaW5lciwgZG9tSXRlbSwgc2Nyb2xsUGFkZGluZyA9IDQpIHtcbiAgaWYgKFxuICAgIGRvbUl0ZW0ub2Zmc2V0SGVpZ2h0IC0gY29udGFpbmVyLnNjcm9sbFRvcCArIGRvbUl0ZW0ub2Zmc2V0VG9wID49XG4gICAgY29udGFpbmVyLm9mZnNldEhlaWdodFxuICApIHtcbiAgICBjb250YWluZXIuc2Nyb2xsVG9wID1cbiAgICAgIGRvbUl0ZW0ub2Zmc2V0SGVpZ2h0ICtcbiAgICAgIGRvbUl0ZW0ub2Zmc2V0VG9wIC1cbiAgICAgIGNvbnRhaW5lci5vZmZzZXRIZWlnaHQgK1xuICAgICAgc2Nyb2xsUGFkZGluZztcbiAgfSBlbHNlIGlmIChkb21JdGVtLm9mZnNldFRvcCA8PSBjb250YWluZXIuc2Nyb2xsVG9wKSB7XG4gICAgY29udGFpbmVyLnNjcm9sbFRvcCA9IGRvbUl0ZW0ub2Zmc2V0VG9wIC0gc2Nyb2xsUGFkZGluZztcbiAgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24gdHJhcEV2ZW50KGV2ZW50OiBFdmVudCkge1xuICBpZiAoIWV2ZW50KSB7IHJldHVybjsgfVxuICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICBldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcbn1cbiJdfQ==